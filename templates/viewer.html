<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAN-OS Configuration Viewer</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- jQuery (required for DataTables) -->
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    
    <!-- DataTables CSS and JS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/dataTables.tailwindcss.min.css">
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.7/js/dataTables.tailwindcss.min.js"></script>
    
    <!-- DataTables Buttons Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.2/css/buttons.dataTables.min.css">
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.colVis.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.2/js/buttons.print.min.js"></script>
    
    <!-- DataTables ColReorder Extension -->
    <link rel="stylesheet" href="https://cdn.datatables.net/colreorder/1.7.0/css/colReorder.dataTables.min.css">
    <script src="https://cdn.datatables.net/colreorder/1.7.0/js/dataTables.colReorder.min.js"></script>
    
    <!-- Custom styles -->
    <style>
        [x-cloak] { display: none !important; }
        .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
        .scrollbar-thin::-webkit-scrollbar-track { background: #f1f1f1; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #888; border-radius: 3px; }
        .scrollbar-thin::-webkit-scrollbar-thumb:hover { background: #555; }
        
        /* DataTables Custom Styling */
        .dataTables_wrapper {
            padding: 0;
        }
        
        /* Search input styling */
        .dataTables_filter {
            margin-bottom: 0.5rem;
        }
        
        .dataTables_filter input {
            padding: 0.375rem 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            width: 250px;
            font-size: 0.875rem;
        }
        
        .dataTables_filter input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.1);
        }
        
        /* Length select styling */
        .dataTables_length {
            margin-bottom: 0.5rem;
        }
        
        .dataTables_length select {
            padding: 0.375rem 2rem 0.375rem 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            font-size: 0.875rem;
        }
        
        /* Buttons styling */
        .dt-buttons {
            margin-bottom: 0.5rem;
            display: flex !important;
            gap: 0.375rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .dt-button {
            padding: 0.375rem 0.75rem !important;
            background-color: #f9fafb !important;
            color: #374151 !important;
            border: 1px solid #d1d5db !important;
            border-radius: 0.375rem !important;
            font-size: 0.8125rem !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: all 0.15s ease-in-out !important;
            display: inline-block !important;
        }
        
        .dt-button:hover {
            background-color: #f3f4f6 !important;
            border-color: #9ca3af !important;
        }
        
        .dt-button:focus {
            outline: none !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }
        
        /* Table styling */
        table.dataTable {
            border-collapse: collapse !important;
            width: 100% !important;
        }
        
        table.dataTable thead {
            background-color: #f9fafb;
        }
        
        table.dataTable thead th {
            padding: 0.5rem 1rem !important;
            text-align: left !important;
            font-size: 0.75rem !important;
            font-weight: 500 !important;
            color: #6b7280 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.05em !important;
            border-bottom: 1px solid #e5e7eb !important;
            cursor: pointer;
            position: relative;
        }
        
        table.dataTable thead th:hover {
            background-color: #f3f4f6;
        }
        
        /* Sorting arrows */
        table.dataTable thead .sorting:before,
        table.dataTable thead .sorting_asc:before,
        table.dataTable thead .sorting_desc:before,
        table.dataTable thead .sorting:after,
        table.dataTable thead .sorting_asc:after,
        table.dataTable thead .sorting_desc:after {
            font-family: 'Font Awesome 6 Free';
            position: absolute;
            right: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.75rem;
            color: #9ca3af;
            font-weight: 900;
        }
        
        table.dataTable thead .sorting:before { content: '\f0dc'; }
        table.dataTable thead .sorting:after { content: ''; }
        table.dataTable thead .sorting_asc:before { content: '\f0de'; color: #374151; }
        table.dataTable thead .sorting_asc:after { content: ''; }
        table.dataTable thead .sorting_desc:before { content: '\f0dd'; color: #374151; }
        table.dataTable thead .sorting_desc:after { content: ''; }
        
        /* Table body styling */
        table.dataTable tbody td {
            padding: 0.75rem 1rem !important;
            font-size: 0.875rem !important;
            color: #374151 !important;
            border-bottom: 1px solid #e5e7eb !important;
        }
        
        table.dataTable tbody tr {
            background-color: white;
        }
        
        table.dataTable tbody tr:hover {
            background-color: #f9fafb !important;
            cursor: pointer;
        }
        
        table.dataTable tbody tr.odd {
            background-color: white;
        }
        
        table.dataTable tbody tr.even {
            background-color: white;
        }
        
        /* Remove default borders */
        table.dataTable,
        table.dataTable td,
        table.dataTable th {
            border: none !important;
        }
        
        /* Pagination styling */
        .dataTables_paginate {
            margin-top: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .dataTables_paginate .paginate_button {
            padding: 0.375rem 0.75rem;
            margin: 0 0.125rem;
            border: 1px solid #d1d5db;
            background-color: white;
            color: #374151;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
        }
        
        .dataTables_paginate .paginate_button:hover:not(.disabled) {
            background-color: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .dataTables_paginate .paginate_button.current {
            background-color: #3b82f6 !important;
            color: white !important;
            border-color: #3b82f6 !important;
        }
        
        .dataTables_paginate .paginate_button.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .dataTables_paginate .paginate_button.previous,
        .dataTables_paginate .paginate_button.next {
            font-weight: 500;
        }
        
        .dataTables_paginate .paginate_button:first-child {
            border-top-left-radius: 0.375rem;
            border-bottom-left-radius: 0.375rem;
        }
        
        .dataTables_paginate .paginate_button:last-child {
            border-top-right-radius: 0.375rem;
            border-bottom-right-radius: 0.375rem;
        }
        
        /* Info text styling */
        .dataTables_info {
            margin-top: 1rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        
        /* Empty table styling */
        .dataTables_empty {
            text-align: center;
            color: #6b7280;
            padding: 2rem !important;
        }
        
        /* Processing indicator */
        .dataTables_processing {
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        /* Wrapper layout */
        .dataTables_wrapper .dataTables_length,
        .dataTables_wrapper .dataTables_filter {
            float: none;
            text-align: left;
        }
        
        .dataTables_wrapper .dataTables_filter {
            text-align: right;
        }
        
        .dataTables_wrapper .dataTables_paginate {
            float: none;
            text-align: center;
        }
        
        .dataTables_wrapper .dataTables_info {
            float: none;
            text-align: center;
            margin-bottom: 0.5rem;
        }
        
        /* Top controls layout */
        .dataTables_wrapper .top {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
        }
        
        .dataTables_wrapper .dt-buttons {
            order: -1;
            flex: 0 0 auto;
        }
        
        .dataTables_wrapper .top .dataTables_length {
            margin-bottom: 0;
        }
        
        .dataTables_wrapper .top .dataTables_filter {
            margin-bottom: 0;
        }
        
        /* Column reorder indicator */
        table.dataTable thead th.reorder-hover {
            background-color: #e0e7ff !important;
        }
        
        /* Make tables responsive with proper scrolling */
        .dataTables_wrapper {
            width: 100%;
        }
        
        .dataTables_scroll {
            overflow: visible !important;
        }
        
        .dataTables_scrollHead {
            overflow: hidden !important;
        }
        
        .dataTables_scrollBody {
            overflow-x: auto !important;
            overflow-y: visible !important;
        }
        
        .dataTables_scrollHeadInner {
            width: 100% !important;
            padding-right: 0 !important;
        }
        
        .dataTables_scrollHeadInner table,
        .dataTables_scrollBody table {
            width: 100% !important;
            table-layout: fixed !important;
        }
        
        /* Fix alignment between header and body */
        .dataTables_scrollHeadInner table thead th,
        .dataTables_scrollBody table tbody td {
            box-sizing: border-box !important;
        }
        
        /* Text overflow handling for table cells */
        table.dataTable th,
        table.dataTable td {
            white-space: normal !important;
            word-wrap: break-word !important;
            word-break: break-word !important;
            overflow-wrap: break-word !important;
            vertical-align: top !important;
            padding: 0.75rem !important;
        }
        
        /* Specific rules for security policies table */
        #securityPoliciesTable td {
            line-height: 1.5;
            min-height: 2.5rem;
            word-break: break-word;
        }
        
        /* Ensure badges don't break */
        #securityPoliciesTable td span {
            display: inline-block;
            white-space: nowrap;
            margin: 0.125rem;
        }
        
        /* Compact pagination */
        .dataTables_paginate {
            margin-top: 0.75rem;
        }
        
        .dataTables_info {
            margin-top: 0.5rem;
            font-size: 0.8125rem;
        }
        
        /* Column visibility dropdown styling */
        .dt-button-collection {
            background-color: white !important;
            border: 1px solid #d1d5db !important;
            border-radius: 0.5rem !important;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05) !important;
            padding: 0.5rem !important;
            min-width: 200px !important;
        }
        
        .dt-button-collection .dt-button {
            display: block !important;
            width: 100% !important;
            text-align: left !important;
            padding: 0.5rem 0.75rem !important;
            margin: 0.125rem 0 !important;
            border: none !important;
            background-color: transparent !important;
            border-radius: 0.375rem !important;
            font-size: 0.875rem !important;
            color: #374151 !important;
            position: relative !important;
            padding-left: 2rem !important;
        }
        
        .dt-button-collection .dt-button:hover {
            background-color: #f3f4f6 !important;
        }
        
        .dt-button-collection .dt-button.active {
            color: #3b82f6 !important;
            font-weight: 500 !important;
        }
        
        .dt-button-collection .dt-button.active::before {
            content: '\2713';
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #3b82f6;
            font-weight: 700;
        }
        
        .buttons-columnVisibility {
            padding-left: 2rem !important;
        }
        
        .dt-button-background {
            background-color: rgba(0, 0, 0, 0.3) !important;
        }
        
        /* Column filter styles */
        .column-filter-row th {
            padding: 5px;
            background-color: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            position: relative;
        }
        
        .column-filter-select {
            width: 100%;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            background-color: white;
        }
        
        .column-filter-select:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Enhanced column filter dropdown */
        .column-filter-container {
            position: relative;
            width: 100%;
        }
        
        .column-filter-button {
            width: 100%;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            color: #374151;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.15s ease-in-out;
        }
        
        .column-filter-button:hover {
            background-color: #f9fafb;
            border-color: #9ca3af;
        }
        
        .column-filter-button:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .column-filter-button.active {
            background-color: #eff6ff;
            border-color: #3b82f6;
            color: #1d4ed8;
        }
        
        .column-filter-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 1000;
            background-color: white;
            border: 1px solid #d1d5db;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 0.75rem;
            margin-top: 0.25rem;
            min-width: 250px;
            display: none;
        }
        
        .column-filter-dropdown.show {
            display: block;
        }
        
        .filter-operator-select {
            width: 100%;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            margin-bottom: 0.75rem;
        }
        
        .filter-operator-select:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .filter-search-input {
            width: 100%;
            padding: 0.375rem 0.75rem;
            font-size: 0.875rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            margin-bottom: 0.75rem;
        }
        
        .filter-search-input:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .filter-actions {
            display: flex;
            gap: 0.5rem;
            border-top: 1px solid #e5e7eb;
            padding-top: 0.75rem;
        }
        
        .filter-action-btn {
            flex: 1;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 500;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
            text-align: center;
        }
        
        .filter-action-btn:hover {
            background-color: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .filter-action-btn.primary {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .filter-action-btn.primary:hover {
            background-color: #2563eb;
            border-color: #2563eb;
        }
        
        .filter-sort-section {
            border-top: 1px solid #e5e7eb;
            padding-top: 0.75rem;
            margin-top: 0.75rem;
        }
        
        .filter-sort-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 0.5rem;
            display: block;
        }
        
        .filter-sort-buttons {
            display: flex;
            gap: 0.375rem;
        }
        
        .filter-sort-btn {
            flex: 1;
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            background-color: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.15s ease-in-out;
            text-align: center;
        }
        
        .filter-sort-btn:hover {
            background-color: #f3f4f6;
            border-color: #9ca3af;
        }
        
        .filter-sort-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        table.dataTable thead .sorting:before,
        table.dataTable thead .sorting_asc:before,
        table.dataTable thead .sorting_desc:before {
            content: "";
        }
        
        table.dataTable thead .sorting:after,
        table.dataTable thead .sorting_asc:after,
        table.dataTable thead .sorting_desc:after {
            content: "";
        }
        
        /* Burger Menu Column Filter Styles */
        .column-burger-menu {
            display: inline-block;
            margin-left: 8px;
            padding: 4px 6px;
            cursor: pointer;
            color: #6b7280;
            border-radius: 3px;
            transition: all 0.2s ease;
            font-size: 12px;
            vertical-align: middle;
        }
        
        .column-burger-menu:hover {
            background-color: #f3f4f6;
            color: #374151;
        }
        
        .column-burger-menu.active {
            background-color: #3b82f6;
            color: white;
        }
        
        .column-burger-menu.filtered {
            background-color: #10b981;
            color: white;
        }
        
        .column-burger-menu.filtered:hover {
            background-color: #059669;
        }
        
        .enhanced-filter-dropdown {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            z-index: 9999;
            min-width: 280px;
            padding: 16px;
            margin-top: 4px;
        }
        
        .enhanced-filter-dropdown.show {
            display: block;
        }
        
        .filter-section {
            margin-bottom: 16px;
        }
        
        .filter-section:last-child {
            margin-bottom: 0;
        }
        
        .filter-section label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 6px;
        }
        
        .enhanced-filter-dropdown .filter-operator-select,
        .enhanced-filter-dropdown .filter-search-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
            background: white;
        }
        
        .enhanced-filter-dropdown .filter-operator-select:focus,
        .enhanced-filter-dropdown .filter-search-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .enhanced-filter-dropdown .filter-sort-buttons {
            display: flex;
            gap: 4px;
        }
        
        .enhanced-filter-dropdown .filter-sort-btn {
            flex: 1;
            padding: 6px 8px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 4px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }
        
        .enhanced-filter-dropdown .filter-sort-btn:hover {
            background-color: #f9fafb;
            border-color: #9ca3af;
        }
        
        .enhanced-filter-dropdown .filter-sort-btn.active {
            background-color: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }
        
        .enhanced-filter-dropdown .filter-actions {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }
        
        .enhanced-filter-dropdown .filter-action-btn {
            flex: 1;
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background: white;
        }
        
        .enhanced-filter-dropdown .filter-action-btn.primary {
            background-color: #3b82f6;
            border-color: #3b82f6;
            color: white;
        }
        
        .enhanced-filter-dropdown .filter-action-btn.primary:hover {
            background-color: #2563eb;
            border-color: #2563eb;
        }
        
        .enhanced-filter-dropdown .filter-action-btn:not(.primary):hover {
            background-color: #f9fafb;
            border-color: #9ca3af;
        }
        
        .enhanced-filter-dropdown .filter-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
            color: #6b7280;
            font-size: 14px;
            border-top: 1px solid #e5e7eb;
            margin-top: 16px;
        }
        
        .enhanced-filter-dropdown .filter-loading i {
            margin-right: 8px;
        }
        
        /* Ensure table headers have relative positioning for dropdown positioning */
        table.dataTable thead th {
            position: relative;
            overflow: visible;
        }
        
        /* Ensure table container allows overflow for dropdowns */
        .dataTables_wrapper {
            overflow: visible;
        }
        
        table.dataTable {
            overflow: visible;
        }
    </style>
</head>
<body class="bg-gray-50" x-data="configViewer()" x-init="init()">
    <!-- Top Navigation Bar -->
    <nav class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <h1 class="text-xl font-semibold text-gray-900">
                        <i class="fas fa-network-wired mr-2 text-blue-600"></i>
                        PAN-OS Configuration Viewer
                    </h1>
                </div>
                
                <!-- Config Selector -->
                <div class="flex items-center space-x-4">
                    <div class="relative" x-cloak>
                        <label class="text-sm font-medium text-gray-700 mr-2">Configuration:</label>
                        <select 
                            x-model="selectedConfig" 
                            @change="loadConfiguration()"
                            class="block w-64 px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                            :disabled="loading || configs.length === 0"
                        >
                            <option value="">Select a configuration...</option>
                            <template x-for="config in configs" :key="config">
                                <option :value="config" x-text="config"></option>
                            </template>
                        </select>
                    </div>
                    
                    <button @click="refreshConfigs()" 
                            class="p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-md"
                            :disabled="loading">
                        <i class="fas fa-sync-alt" :class="loading ? 'animate-spin' : ''"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <div class="flex h-screen pt-16" style="height: calc(100vh - 4rem);">
        <!-- Sidebar Navigation -->
        <nav class="w-64 bg-white shadow-lg overflow-y-auto scrollbar-thin">
            <div class="p-4">
                <h2 class="text-sm font-semibold text-gray-600 uppercase tracking-wider mb-4">
                    Configuration Objects
                </h2>
                
                <ul class="space-y-1">
                    <!-- Address Objects -->
                    <li>
                        <button @click="activeSection = 'addresses'; loadAddresses()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'addresses' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-map-marker-alt w-5"></i>
                            Address Objects
                            <span x-show="stats.addresses !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.addresses"></span>
                        </button>
                    </li>
                    
                    <!-- Address Groups -->
                    <li>
                        <button @click="activeSection = 'address-groups'; loadAddressGroups()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'address-groups' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-object-group w-5"></i>
                            Address Groups
                            <span x-show="stats.addressGroups !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.addressGroups"></span>
                        </button>
                    </li>
                    
                    <!-- Services -->
                    <li>
                        <button @click="activeSection = 'services'; loadServices()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'services' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-server w-5"></i>
                            Service Objects
                            <span x-show="stats.services !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.services"></span>
                        </button>
                    </li>
                    
                    <!-- Service Groups -->
                    <li>
                        <button @click="activeSection = 'service-groups'; loadServiceGroups()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'service-groups' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-layer-group w-5"></i>
                            Service Groups
                            <span x-show="stats.serviceGroups !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.serviceGroups"></span>
                        </button>
                    </li>
                    
                    <!-- Device Groups -->
                    <li>
                        <button @click="activeSection = 'device-groups'; loadDeviceGroups()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'device-groups' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-sitemap w-5"></i>
                            Device Groups
                            <span x-show="stats.deviceGroups !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.deviceGroups"></span>
                        </button>
                    </li>
                    
                    <!-- Security Policies -->
                    <li>
                        <button @click="activeSection = 'security-policies'; loadSecurityPolicies()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'security-policies' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-shield-alt w-5"></i>
                            Security Policies
                            <span x-show="stats.securityPolicies !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.securityPolicies"></span>
                        </button>
                    </li>
                    
                    <!-- Templates -->
                    <li>
                        <button @click="activeSection = 'templates'; loadTemplates()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection === 'templates' ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-file-alt w-5"></i>
                            Templates
                            <span x-show="stats.templates !== null" class="float-right text-xs bg-gray-200 px-2 py-1 rounded-full" x-text="stats.templates"></span>
                        </button>
                    </li>
                    
                    <!-- Security Profiles -->
                    <li>
                        <button @click="toggleSecurityProfiles()"
                                class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                :class="activeSection.startsWith('security-') ? 'bg-blue-100 text-blue-700' : 'text-gray-700 hover:bg-gray-100'">
                            <i class="fas fa-shield-alt w-5"></i>
                            Security Profiles
                            <i class="fas fa-chevron-down float-right transition-transform" :class="showSecurityProfiles ? 'rotate-180' : ''"></i>
                        </button>
                        
                        <!-- Security Profiles Submenu -->
                        <ul x-show="showSecurityProfiles" x-transition class="ml-4 mt-1 space-y-1">
                            <li>
                                <button @click="activeSection = 'security-vulnerability'; loadSecurityProfiles('vulnerability')"
                                        class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                        :class="activeSection === 'security-vulnerability' ? 'bg-blue-100 text-blue-700' : 'text-gray-600 hover:bg-gray-100'">
                                    <i class="fas fa-bug w-4"></i>
                                    Vulnerability
                                </button>
                            </li>
                            <li>
                                <button @click="activeSection = 'security-url'; loadSecurityProfiles('url-filtering')"
                                        class="w-full text-left px-3 py-2 text-sm rounded-md transition-colors"
                                        :class="activeSection === 'security-url' ? 'bg-blue-100 text-blue-700' : 'text-gray-600 hover:bg-gray-100'">
                                    <i class="fas fa-link w-4"></i>
                                    URL Filtering
                                </button>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="flex-1 overflow-y-auto bg-gray-50">
            <!-- Loading State -->
            <div x-show="loading" class="flex items-center justify-center h-full">
                <div class="text-center">
                    <i class="fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"></i>
                    <p class="text-gray-600">Loading...</p>
                </div>
            </div>

            <!-- No Config Selected -->
            <div x-show="!loading && !selectedConfig" class="flex items-center justify-center h-full">
                <div class="text-center">
                    <i class="fas fa-folder-open text-6xl text-gray-300 mb-4"></i>
                    <p class="text-xl text-gray-600 mb-2">No Configuration Selected</p>
                    <p class="text-gray-500">Please select a configuration from the dropdown above</p>
                </div>
            </div>

            <!-- Content Area -->
            <div x-show="!loading && selectedConfig && activeSection" x-cloak class="p-6">
                <!-- Addresses Section -->
                <div x-show="activeSection === 'addresses'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Address Objects</h2>
                        <p class="text-gray-600 mt-1">IP addresses, FQDNs, and ranges defined in the configuration</p>
                    </div>

                    <!-- DataTable Container -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table id="addressesTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Value</th>
                                    <th>Location</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Address Groups Section -->
                <div x-show="activeSection === 'address-groups'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Address Groups</h2>
                        <p class="text-gray-600 mt-1">Static and dynamic address groups</p>
                    </div>

                    <!-- DataTable Container -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table id="addressGroupsTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Type</th>
                                    <th>Members</th>
                                    <th>Location</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Services Section -->
                <div x-show="activeSection === 'services'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Service Objects</h2>
                        <p class="text-gray-600 mt-1">TCP/UDP service definitions</p>
                    </div>

                    <!-- DataTable Container -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table id="servicesTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Protocol</th>
                                    <th>Port</th>
                                    <th>Location</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <!-- Service Groups Section -->
                <div x-show="activeSection === 'service-groups'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Service Groups</h2>
                        <p class="text-gray-600 mt-1">Collections of service objects</p>
                    </div>

                    <!-- Service Groups DataTable -->
                    <div class="bg-white shadow-sm rounded-lg overflow-hidden p-4">
                        <table id="serviceGroupsTable" class="display" style="width:100%">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Members</th>
                                    <th>Location</th>
                                    <th>Description</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div x-show="activeSection === 'device-groups'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Device Groups</h2>
                        <p class="text-gray-600 mt-1">Device group hierarchy and configurations</p>
                    </div>
                    
                    <!-- Device Groups DataTable -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table id="deviceGroupsTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Parent</th>
                                    <th>Addresses</th>
                                    <th>Services</th>
                                    <th>Pre Rules</th>
                                    <th>Post Rules</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Security Policies Section -->
                <div x-show="activeSection === 'security-policies'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Security Policies</h2>
                        <p class="text-gray-600 mt-1">Security rules configured across device groups</p>
                    </div>

                    <!-- Security Policies DataTable -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <div class="overflow-x-auto">
                            <table id="securityPoliciesTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Order</th>
                                    <th>Rule Name</th>
                                    <th>From Zone</th>
                                    <th>To Zone</th>
                                    <th>Source</th>
                                    <th>Destination</th>
                                    <th>Application</th>
                                    <th>Service</th>
                                    <th>Action</th>
                                    <th>Profile</th>
                                    <th>Device Group</th>
                                    <th>Type</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                        </div>
                    </div>
                </div>
                
                <!-- Templates Section -->
                <div x-show="activeSection === 'templates'">
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">Templates</h2>
                        <p class="text-gray-600 mt-1">Device templates configuration</p>
                    </div>
                    
                    <!-- Templates DataTable -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table id="templatesTable" class="display w-full">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Description</th>
                                    <th>Device Count</th>
                                    <th>Config Count</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Security Profiles Section -->
                <div x-show="activeSection.startsWith('security-')" x-cloak>
                    <div class="mb-6">
                        <h2 class="text-2xl font-bold text-gray-900" x-text="activeSection === 'security-vulnerability' ? 'Vulnerability Profiles' : activeSection === 'security-url' ? 'URL Filtering Profiles' : 'Security Profiles'"></h2>
                        <p class="text-gray-600 mt-1">Security profile configurations</p>
                    </div>
                    
                    <!-- Security Profiles Table -->
                    <div class="bg-white shadow-sm rounded-lg p-4">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                    <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-6 py-3 bg-gray-50"></th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <template x-for="profile in filteredData" :key="profile.name">
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900" x-text="profile.name"></td>
                                        <td class="px-6 py-4 text-sm text-gray-500" x-text="profile.description || '-'"></td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                            <span class="px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded-full" x-text="activeSection.replace('security-', '').replace('-', ' ')"></span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button @click="showDetail(profile)" class="text-blue-600 hover:text-blue-900">
                                                <i class="fas fa-eye"></i> View
                                            </button>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Detail Modal -->
    <div x-show="showDetailModal" x-cloak
         class="fixed inset-0 z-50 overflow-y-auto"
         @click.away="showDetailModal = false">
        <div class="flex items-center justify-center min-h-screen px-4">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>
            
            <div class="relative bg-white rounded-lg max-w-3xl w-full max-h-[80vh] overflow-hidden">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900" x-text="detailItem.name"></h3>
                    <button @click="showDetailModal = false" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="px-6 py-4 overflow-y-auto max-h-[60vh]">
                    <pre class="bg-gray-50 p-4 rounded-md text-sm overflow-x-auto" x-text="JSON.stringify(detailItem, null, 2)"></pre>
                </div>
            </div>
        </div>
    </div>

    <script>
        function configViewer() {
            return {
                // State
                loading: false,
                configs: [],
                selectedConfig: '',
                activeSection: '',
                showSecurityProfiles: false,
                currentData: [],
                filteredData: [],
                showDetailModal: false,
                detailItem: {},
                
                
                // Statistics
                stats: {
                    addresses: null,
                    addressGroups: null,
                    services: null,
                    serviceGroups: null,
                    deviceGroups: null,
                    templates: null,
                    securityPolicies: null
                },
                
                // Methods
                async init() {
                    await this.refreshConfigs();
                },
                
                async refreshConfigs() {
                    this.loading = true;
                    try {
                        const response = await fetch('/api/v1/configs');
                        const data = await response.json();
                        this.configs = data.configs;
                        
                        // Auto-select first config if only one available
                        if (this.configs.length === 1) {
                            this.selectedConfig = this.configs[0];
                            await this.loadConfiguration();
                        }
                    } catch (error) {
                        console.error('Failed to load configs:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                async loadConfiguration() {
                    if (!this.selectedConfig) return;
                    
                    // Reset state
                    this.activeSection = '';
                    this.currentData = [];
                    this.filteredData = [];
                    this.stats = {
                        addresses: null,
                        addressGroups: null,
                        services: null,
                        serviceGroups: null,
                        deviceGroups: null,
                        templates: null
                    };
                    
                    // Load initial stats
                    await this.loadStats();
                },
                
                async loadStats() {
                    // Load counts for sidebar badges
                    try {
                        // Addresses - fetch with page_size=1 to just get total count
                        const addrResp = await fetch(`/api/v1/configs/${this.selectedConfig}/addresses?page_size=1`);
                        const addresses = await addrResp.json();
                        this.stats.addresses = addresses.total_items;
                        
                        // Device Groups
                        const dgResp = await fetch(`/api/v1/configs/${this.selectedConfig}/device-groups?page_size=1`);
                        const deviceGroups = await dgResp.json();
                        this.stats.deviceGroups = deviceGroups.total_items;
                        
                        // Templates
                        const tmplResp = await fetch(`/api/v1/configs/${this.selectedConfig}/templates?page_size=1`);
                        const templates = await tmplResp.json();
                        this.stats.templates = templates.total_items;
                        
                        // Add more stats loading as needed
                    } catch (error) {
                        console.error('Failed to load stats:', error);
                    }
                },
                
                async loadAddresses() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initAddressesDataTable();
                    } catch (error) {
                        console.error('Failed to initialize addresses table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                initAddressesDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#addressesTable')) {
                        $('#addressesTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#addressesTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/addresses`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._datatablesDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1,
                                    location: 'all'  // Get addresses from all locations
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                // Add column filters if present
                                const tableFilters = alpineComponent.columnFilters['addressesTable'];
                                if (tableFilters && Object.keys(tableFilters).length > 0) {
                                    for (const [field, filter] of Object.entries(tableFilters)) {
                                        if (filter.operator === 'equals' || filter.operator === 'contains') {
                                            params[`filter[${field}]`] = filter.value;
                                        } else {
                                            params[`filter[${field}][${filter.operator}]`] = filter.value;
                                        }
                                    }
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._datatablesDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(item => {
                                        const type = alpineComponent.getAddressType(item);
                                        const typeHtml = type === 'ip-netmask' ? '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">IP/Netmask</span>' :
                                                        type === 'fqdn' ? '<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">FQDN</span>' :
                                                        type === 'ip-range' ? '<span class="px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full">IP Range</span>' : '';
                                        
                                        const value = item['ip-netmask'] || item.fqdn || item['ip-range'] || '-';
                                        
                                        const location = !item['parent-device-group'] && !item['parent-template'] ? '<span class="text-gray-400">Shared</span>' :
                                                       item['parent-device-group'] ? `<span class="text-blue-600">DG: ${item['parent-device-group']}</span>` :
                                                       item['parent-template'] ? `<span class="text-green-600">Template: ${item['parent-template']}</span>` : '';
                                        
                                        return [
                                            item.name,
                                            typeHtml,
                                            value,
                                            location,
                                            item.description || '-',
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.addresses = json.total_items;
                                }
                            }
                        },
                        columns: [
                            { title: 'Name' },
                            { title: 'Type' },
                            { title: 'Value' },
                            { title: 'Location' },
                            { title: 'Description' },
                            { title: 'Actions', orderable: false }
                        ],
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'pdf',
                                text: '<i class="fas fa-file-pdf"></i> PDF',
                                className: 'dt-button-pdf',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'print',
                                text: '<i class="fas fa-print"></i> Print',
                                className: 'dt-button-print',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search addresses...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ addresses",
                            processing: '<div class="flex items-center justify-center"><i class="fas fa-spinner fa-spin mr-2"></i>Loading addresses...</div>',
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No addresses found"
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column at index 5)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [5]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.addressesTable = table;
                },
                
                initAddressGroupsDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#addressGroupsTable')) {
                        $('#addressGroupsTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#addressGroupsTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/address-groups`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._addressGroupsTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                // Add column filters if present
                                const tableFilters = alpineComponent.columnFilters['addressGroupsTable'];
                                if (tableFilters && Object.keys(tableFilters).length > 0) {
                                    for (const [field, filter] of Object.entries(tableFilters)) {
                                        if (filter.operator === 'equals' || filter.operator === 'contains') {
                                            params[`filter[${field}]`] = filter.value;
                                        } else {
                                            params[`filter[${field}][${filter.operator}]`] = filter.value;
                                        }
                                    }
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._addressGroupsTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(item => {
                                        const members = item.members || [];
                                        const membersHtml = members.length > 0 
                                            ? `<div class="max-w-md inline-flex flex-wrap gap-1">
                                                ${members.slice(0, 4).map(m => `<span class="px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md">${m}</span>`).join('')}
                                                ${members.length > 4 ? `<span class="px-2 py-1 text-xs bg-gray-200 text-gray-600 rounded-md">+${members.length - 4} more</span>` : ''}
                                               </div>`
                                            : '<span class="text-gray-400">No members</span>';
                                        
                                        const location = !item['parent-device-group'] && !item['parent-template'] ? '<span class="text-gray-400">Shared</span>' :
                                                       item['parent-device-group'] ? `<span class="text-blue-600">DG: ${item['parent-device-group']}</span>` :
                                                       item['parent-template'] ? `<span class="text-green-600">Template: ${item['parent-template']}</span>` : '';
                                        
                                        const typeHtml = item.static ? '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">Static</span>' :
                                                       item.dynamic ? '<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Dynamic</span>' : '';
                                        
                                        return [
                                            item.name,
                                            typeHtml,
                                            membersHtml,
                                            location,
                                            item.description || '-',
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.addressGroups = json.total_items;
                                }
                            }
                        },
                        columns: [
                            { title: 'Name' },
                            { title: 'Type' },
                            { title: 'Members' },
                            { title: 'Location' },
                            { title: 'Description' },
                            { title: 'Actions', orderable: false }
                        ],
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'pdf',
                                text: '<i class="fas fa-file-pdf"></i> PDF',
                                className: 'dt-button-pdf',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'print',
                                text: '<i class="fas fa-print"></i> Print',
                                className: 'dt-button-print',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search address groups...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ address groups",
                            processing: '<div class="flex items-center justify-center"><i class="fas fa-spinner fa-spin mr-2"></i>Loading address groups...</div>',
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No address groups found"
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column at index 5)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [5]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.addressGroupsTable = table;
                },
                
                initServicesDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#servicesTable')) {
                        $('#servicesTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#servicesTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/services`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._servicesTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                // Add column filters if present
                                const tableFilters = alpineComponent.columnFilters['servicesTable'];
                                if (tableFilters && Object.keys(tableFilters).length > 0) {
                                    for (const [field, filter] of Object.entries(tableFilters)) {
                                        if (filter.operator === 'equals' || filter.operator === 'contains') {
                                            params[`filter[${field}]`] = filter.value;
                                        } else {
                                            params[`filter[${field}][${filter.operator}]`] = filter.value;
                                        }
                                    }
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._servicesTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(item => {
                                        const protocolHtml = (item.protocol && item.protocol.tcp ? '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">TCP</span> ' : '') +
                                                           (item.protocol && item.protocol.udp ? '<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">UDP</span>' : '');
                                        
                                        const port = alpineComponent.getServicePort(item);
                                        
                                        const location = !item['parent-device-group'] && !item['parent-template'] ? '<span class="text-gray-400">Shared</span>' :
                                                       item['parent-device-group'] ? `<span class="text-blue-600">DG: ${item['parent-device-group']}</span>` :
                                                       item['parent-template'] ? `<span class="text-green-600">Template: ${item['parent-template']}</span>` : '';
                                        
                                        return [
                                            item.name,
                                            protocolHtml,
                                            port,
                                            location,
                                            item.description || '-',
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.services = json.total_items;
                                }
                            }
                        },
                        columns: [
                            { title: 'Name' },
                            { title: 'Protocol' },
                            { title: 'Port' },
                            { title: 'Location' },
                            { title: 'Description' },
                            { title: 'Actions', orderable: false }
                        ],
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'pdf',
                                text: '<i class="fas fa-file-pdf"></i> PDF',
                                className: 'dt-button-pdf',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'print',
                                text: '<i class="fas fa-print"></i> Print',
                                className: 'dt-button-print',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search services...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ services",
                            processing: '<div class="flex items-center justify-center"><i class="fas fa-spinner fa-spin mr-2"></i>Loading services...</div>',
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No services found"
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column at index 5)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [5]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.servicesTable = table;
                },
                
                initServiceGroupsDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#serviceGroupsTable')) {
                        $('#serviceGroupsTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#serviceGroupsTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/service-groups`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._serviceGroupsTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                // Add column filters if present
                                const tableFilters = alpineComponent.columnFilters['serviceGroupsTable'];
                                if (tableFilters && Object.keys(tableFilters).length > 0) {
                                    for (const [field, filter] of Object.entries(tableFilters)) {
                                        if (filter.operator === 'equals' || filter.operator === 'contains') {
                                            params[`filter[${field}]`] = filter.value;
                                        } else {
                                            params[`filter[${field}][${filter.operator}]`] = filter.value;
                                        }
                                    }
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._serviceGroupsTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(item => {
                                        const members = item.members || [];
                                        const membersHtml = members.length > 0 
                                            ? `<div class="max-w-md inline-flex flex-wrap gap-1">
                                                ${members.slice(0, 4).map(m => `<span class="px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-md">${m}</span>`).join('')}
                                                ${members.length > 4 ? `<span class="px-2 py-1 text-xs bg-gray-200 text-gray-600 rounded-md">+${members.length - 4} more</span>` : ''}
                                               </div>`
                                            : '<span class="text-gray-400">No members</span>';
                                        
                                        const location = !item['parent-device-group'] && !item['parent-template'] ? '<span class="text-gray-400">Shared</span>' :
                                                       item['parent-device-group'] ? `<span class="text-blue-600">DG: ${item['parent-device-group']}</span>` :
                                                       item['parent-template'] ? `<span class="text-green-600">Template: ${item['parent-template']}</span>` : '';
                                        
                                        return [
                                            item.name,
                                            membersHtml,
                                            location,
                                            item.description || '-',
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(item).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.serviceGroups = json.total_items;
                                }
                            }
                        },
                        columns: [
                            { title: 'Name' },
                            { title: 'Members' },
                            { title: 'Location' },
                            { title: 'Description' },
                            { title: 'Actions', orderable: false }
                        ],
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy'
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv'
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel'
                            },
                            {
                                extend: 'pdf',
                                text: '<i class="fas fa-file-pdf"></i> PDF',
                                className: 'dt-button-pdf'
                            },
                            {
                                extend: 'print',
                                text: '<i class="fas fa-print"></i> Print',
                                className: 'dt-button-print'
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search service groups...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ service groups",
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No service groups found"
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column at index 4)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [4]);
                            }
                        }
                    });
                },
                
                initSecurityPoliciesDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#securityPoliciesTable')) {
                        $('#securityPoliciesTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#securityPoliciesTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/security-policies`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._securityPoliciesTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                // Add column filters if present
                                const tableFilters = alpineComponent.columnFilters['securityPoliciesTable'];
                                if (tableFilters && Object.keys(tableFilters).length > 0) {
                                    for (const [field, filter] of Object.entries(tableFilters)) {
                                        if (filter.operator === 'equals' || filter.operator === 'contains') {
                                            params[`filter[${field}]`] = filter.value;
                                        } else {
                                            params[`filter[${field}][${filter.operator}]`] = filter.value;
                                        }
                                    }
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._securityPoliciesTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(rule => {
                                        // Helper function to format arrays with wrapping-friendly separators
                                        const formatArray = (arr) => {
                                            if (!arr || !Array.isArray(arr)) return arr || 'any';
                                            return arr.join(', ');
                                        };
                                        
                                        const fromZones = formatArray(rule.from_);
                                        const toZones = formatArray(rule.to);
                                        const sources = formatArray(rule.source);
                                        const destinations = formatArray(rule.destination);
                                        const applications = formatArray(rule.application);
                                        const services = formatArray(rule.service);
                                        
                                        const actionBadge = rule.action === 'allow' ? 
                                            '<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">Allow</span>' :
                                            rule.action === 'deny' ? 
                                            '<span class="px-2 py-1 text-xs bg-red-100 text-red-800 rounded-full">Deny</span>' :
                                            '<span class="px-2 py-1 text-xs bg-gray-100 text-gray-800 rounded-full">' + rule.action + '</span>';
                                        
                                        const profileInfo = rule.profile_setting ? 'Enabled' : 'None';
                                        
                                        const statusBadge = rule.disabled ? 
                                            '<span class="px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded-full">Disabled</span>' :
                                            '<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">Enabled</span>';
                                        
                                        const typeBadge = rule.parent_device_group ? 
                                            '<span class="px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full">Pre/Post</span>' :
                                            '<span class="px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full">Shared</span>';
                                        
                                        return [
                                            rule.order,
                                            rule.name,
                                            fromZones,
                                            toZones,
                                            sources,
                                            destinations,
                                            applications,
                                            services,
                                            actionBadge,
                                            profileInfo,
                                            rule.device_group || '-',
                                            typeBadge,
                                            statusBadge,
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(rule).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.securityPolicies = json.total_items;
                                }
                            }
                        },
                        columns: [
                            { title: 'Order' },
                            { title: 'Name' },
                            { title: 'From Zone' },
                            { title: 'To Zone' },
                            { title: 'Source' },
                            { title: 'Destination' },
                            { title: 'Application' },
                            { title: 'Service' },
                            { title: 'Action' },
                            { title: 'Profile' },
                            { title: 'Device Group' },
                            { title: 'Type' },
                            { title: 'Status' },
                            { title: 'Actions', orderable: false }
                        ],
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        order: [[0, 'asc']], // Sort by Order column by default
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search security policies...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ security policies",
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No security policies found",
                            processing: "Loading security policies..."
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Order and Actions columns)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [0, 13]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.securityPoliciesTable = table;
                },
                
                async loadAddressGroups() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initAddressGroupsDataTable();
                    } catch (error) {
                        console.error('Failed to initialize address groups table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                async loadServices() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initServicesDataTable();
                    } catch (error) {
                        console.error('Failed to initialize services table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                async loadServiceGroups() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initServiceGroupsDataTable();
                    } catch (error) {
                        console.error('Failed to initialize service groups table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                async loadDeviceGroups() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initDeviceGroupsDataTable();
                    } catch (error) {
                        console.error('Failed to initialize device groups table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                initDeviceGroupsDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#deviceGroupsTable')) {
                        $('#deviceGroupsTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#deviceGroupsTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/device-groups`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._deviceGroupsTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._deviceGroupsTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(dg => {
                                        return [
                                            dg.name,
                                            dg.description || '-',
                                            dg.parent_dg || '<span class="text-gray-400">None</span>',
                                            `<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">${dg.address_count || 0}</span>`,
                                            `<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">${dg.service_count || 0}</span>`,
                                            `<span class="px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded-full">${dg.pre_security_rules_count || 0}</span>`,
                                            `<span class="px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full">${dg.post_security_rules_count || 0}</span>`,
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDeviceGroupDetail(${JSON.stringify(dg).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.deviceGroups = json.total_items;
                                }
                            }
                        },
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search device groups...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ device groups",
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No device groups found",
                            processing: "Loading device groups..."
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [7]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.deviceGroupsTable = table;
                },
                
                async loadTemplates() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initTemplatesDataTable();
                    } catch (error) {
                        console.error('Failed to initialize templates table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                initTemplatesDataTable() {
                    // Destroy existing DataTable if it exists
                    if ($.fn.DataTable.isDataTable('#templatesTable')) {
                        $('#templatesTable').DataTable().destroy();
                    }
                    
                    // Make Alpine.js component available globally for onclick handlers
                    const alpineComponent = this;
                    window.configViewer = alpineComponent;
                    
                    // Initialize DataTable with server-side processing
                    const table = $('#templatesTable').DataTable({
                        serverSide: true,
                        processing: true,
                        ajax: {
                            url: `/api/v1/configs/${this.selectedConfig}/templates`,
                            type: 'GET',
                            data: function(d) {
                                // Store draw for later use
                                alpineComponent._templatesTableDraw = d.draw;
                                
                                // Map DataTables parameters to API parameters
                                const params = {
                                    page: Math.floor(d.start / d.length) + 1,
                                    page_size: d.length === -1 ? 10000 : d.length,
                                    disable_paging: d.length === -1
                                };
                                
                                // Add search parameter if present
                                if (d.search && d.search.value) {
                                    params.name = d.search.value;
                                }
                                
                                return params;
                            },
                            dataFilter: function(data) {
                                const json = JSON.parse(data);
                                // Map API response to DataTables format
                                return JSON.stringify({
                                    draw: alpineComponent._templatesTableDraw || 1,
                                    recordsTotal: json.total_items,
                                    recordsFiltered: json.total_items,
                                    data: json.items.map(template => {
                                        return [
                                            template.name,
                                            template.description || '-',
                                            `<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">${template.device_count || 0}</span>`,
                                            `<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">${template.config?.devices?.entry?.length || 0}</span>`,
                                            `<button class="text-blue-600 hover:text-blue-800" onclick="window.configViewer.showDetail(${JSON.stringify(template).replace(/"/g, '&quot;')})">
                                                <i class="fas fa-eye"></i> View
                                            </button>`
                                        ];
                                    })
                                });
                            },
                            complete: function(xhr) {
                                // Update stats after successful load
                                if (xhr.status === 200) {
                                    const json = JSON.parse(xhr.responseText);
                                    alpineComponent.stats.templates = json.total_items;
                                }
                            }
                        },
                        pageLength: 25,
                        lengthMenu: [[10, 25, 50, 100, -1], [10, 25, 50, 100, "All"]],
                        dom: 'Blfrtip',
                        colReorder: true,
                        autoWidth: false,
                        buttons: [
                            {
                                extend: 'colvis',
                                text: '<i class="fas fa-columns"></i> Columns',
                                className: 'dt-button-colvis',
                                columns: ':not(.noVis)'
                            },
                            {
                                extend: 'copy',
                                text: '<i class="fas fa-copy"></i> Copy',
                                className: 'dt-button-copy',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'csv',
                                text: '<i class="fas fa-file-csv"></i> CSV',
                                className: 'dt-button-csv',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            },
                            {
                                extend: 'excel',
                                text: '<i class="fas fa-file-excel"></i> Excel',
                                className: 'dt-button-excel',
                                exportOptions: {
                                    columns: ':visible:not(:last-child)'
                                }
                            }
                        ],
                        language: {
                            search: "_INPUT_",
                            searchPlaceholder: "Search templates...",
                            lengthMenu: "Show _MENU_ entries",
                            info: "Showing _START_ to _END_ of _TOTAL_ templates",
                            paginate: {
                                first: "First",
                                last: "Last",
                                next: "Next",
                                previous: "Previous"
                            },
                            emptyTable: "No templates found",
                            processing: "Loading templates..."
                        },
                        initComplete: function () {
                            var api = this.api();
                            var self = window.configViewer; // Use the preserved Alpine component
                            
                            // Add enhanced column filters (skip Actions column)
                            if (self && self.addEnhancedColumnFilters) {
                                self.addEnhancedColumnFilters(api, [4]);
                            }
                        }
                    });
                    
                    // Store table reference for later use
                    this.templatesTable = table;
                },
                
                async loadSecurityPolicies() {
                    this.loading = true;
                    try {
                        // Initialize DataTable with server-side processing
                        this.initSecurityPoliciesDataTable();
                    } catch (error) {
                        console.error('Failed to initialize security policies table:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                async loadSecurityProfiles(type) {
                    this.loading = true;
                    try {
                        const response = await fetch(`/api/v1/configs/${this.selectedConfig}/security-profiles/${type}`);
                        this.currentData = await response.json();
                        this.filteredData = [...this.currentData];
                    } catch (error) {
                        console.error('Failed to load security profiles:', error);
                    } finally {
                        this.loading = false;
                    }
                },
                
                toggleSecurityProfiles() {
                    this.showSecurityProfiles = !this.showSecurityProfiles;
                },
                
                
                getAddressType(item) {
                    if (item['ip-netmask']) return 'ip-netmask';
                    if (item.fqdn) return 'fqdn';
                    if (item['ip-range']) return 'ip-range';
                    return '';
                },
                
                
                getServicePort(item) {
                    if (item.protocol) {
                        if (item.protocol.tcp && item.protocol.tcp.port) {
                            return item.protocol.tcp.port;
                        }
                        if (item.protocol.udp && item.protocol.udp.port) {
                            return item.protocol.udp.port;
                        }
                    }
                    return '-';
                },
                
                
                
                showDetail(item) {
                    this.detailItem = item;
                    this.showDetailModal = true;
                },
                
                showDeviceGroupDetail(dg) {
                    this.detailItem = dg;
                    this.showDetailModal = true;
                },
                
                // Build regex for different filter operators
                buildFilterRegex(operator, value) {
                    if (!value && operator !== 'empty' && operator !== 'not_empty') {
                        return '';
                    }
                    
                    // Escape special regex characters
                    var escapedValue = value ? value.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') : '';
                    
                    switch (operator) {
                        case 'contains':
                            return escapedValue;
                        case 'not_contains':
                            return '^(?!.*' + escapedValue + ').*$';
                        case 'equals':
                            return '^' + escapedValue + '$';
                        case 'not_equals':
                            return '^(?!' + escapedValue + '$).*$';
                        case 'starts':
                            return '^' + escapedValue;
                        case 'ends':
                            return escapedValue + '$';
                        case 'empty':
                            return '^$|^-$|^\\s*$';
                        case 'not_empty':
                            return '^(?!$|^-$|^\\s*$).*$';
                        default:
                            return escapedValue;
                    }
                },
                
                // Store column filters for server-side processing
                columnFilters: {},
                
                // Debounce timer for column filters
                filterDebounceTimer: null,
                
                // Helper function to build filter regex for client-side filtering
                buildFilterRegex(operator, value) {
                    const escapedValue = value.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, '\\$&');
                    
                    switch (operator) {
                        case 'contains':
                            return escapedValue;
                        case 'not_contains':
                            return '^(?!.*' + escapedValue + ')';
                        case 'equals':
                            return '^' + escapedValue + '$';
                        case 'ne':
                        case 'not_equals':
                            return '^(?!' + escapedValue + '$)';
                        case 'starts':
                        case 'starts_with':
                            return '^' + escapedValue;
                        case 'ends':
                        case 'ends_with':
                            return escapedValue + '$';
                        case 'empty':
                            return '^\\s*$';
                        case 'not_empty':
                            return '^(?!\\s*$)';
                        default:
                            return escapedValue;
                    }
                },
                
                // Helper function to get column name mapping for each table
                getColumnFieldMapping(tableId, columnIndex) {
                    const mappings = {
                        'addressesTable': ['name', 'type', 'value', 'location', 'description'],
                        'addressGroupsTable': ['name', 'type', 'members', 'location', 'description'],
                        'servicesTable': ['name', 'protocol', 'port', 'location', 'description'],
                        'serviceGroupsTable': ['name', 'members', 'location', 'description'],
                        'securityPoliciesTable': ['order', 'name', 'rule_type', 'source_zones', 'source_addresses', 
                                                'destination_zones', 'destination_addresses', 'applications', 
                                                'services', 'action', 'log_setting', 'profile_settings', 'description'],
                        'deviceGroupsTable': ['name', 'parent', 'devices', 'addresses', 'services', 'policies', 'description'],
                        'templatesTable': ['name', 'devices', 'variables', 'description']
                    };
                    
                    return mappings[tableId] ? mappings[tableId][columnIndex] : null;
                },
                
                // Helper function to add enhanced column filters
                addEnhancedColumnFilters(api, skipColumns = []) {
                    // Check if server-side processing is enabled
                    const isServerSide = api.settings()[0].oFeatures.bServerSide;
                    const tableId = api.table().node().id;
                    const self = this;
                    
                    // Initialize column filters for this table if not exists
                    if (!self.columnFilters[tableId]) {
                        self.columnFilters[tableId] = {};
                    }
                    
                    // Add burger menu icons to column headers
                    api.columns().every(function (index) {
                        // Skip specified columns
                        if (skipColumns.includes(index)) return;
                        
                        var column = this;
                        var $header = $(column.header());
                        const columnField = self.getColumnFieldMapping(tableId, index);
                        
                        // Skip if no field mapping or burger menu already exists
                        if (!columnField || $header.find('.column-burger-menu').length > 0) return;
                        
                        // Create burger menu icon
                        var burgerMenu = $('<span class="column-burger-menu" title="Filter options">' +
                            '<i class="fas fa-bars"></i>' +
                            '</span>');
                        
                        // Create dropdown menu
                        var dropdown = $('<div class="enhanced-filter-dropdown">' +
                            '<div class="filter-section">' +
                                '<label>Filter Type:</label>' +
                                '<select class="filter-operator-select">' +
                                    '<option value="contains">Contains</option>' +
                                    '<option value="not_contains">Does not contain</option>' +
                                    '<option value="equals">Equals</option>' +
                                    '<option value="ne">Does not equal</option>' +
                                    '<option value="starts_with">Starts with</option>' +
                                    '<option value="ends_with">Ends with</option>' +
                                    '<option value="empty">Empty</option>' +
                                    '<option value="not_empty">Not empty</option>' +
                                '</select>' +
                            '</div>' +
                            '<div class="filter-section">' +
                                '<label>Search:</label>' +
                                '<input type="text" class="filter-search-input" placeholder="Enter search term...">' +
                            '</div>' +
                            '<div class="filter-section">' +
                                '<label>Sort:</label>' +
                                '<div class="filter-sort-buttons">' +
                                    '<button type="button" class="filter-sort-btn" data-sort="asc">' +
                                        '<i class="fas fa-sort-alpha-down"></i> A-Z' +
                                    '</button>' +
                                    '<button type="button" class="filter-sort-btn" data-sort="desc">' +
                                        '<i class="fas fa-sort-alpha-up"></i> Z-A' +
                                    '</button>' +
                                    '<button type="button" class="filter-sort-btn" data-sort="clear">' +
                                        '<i class="fas fa-times"></i> Clear' +
                                    '</button>' +
                                '</div>' +
                            '</div>' +
                            '<div class="filter-actions">' +
                                '<button type="button" class="filter-action-btn primary apply-filter">Apply</button>' +
                                '<button type="button" class="filter-action-btn clear-filter">Clear</button>' +
                            '</div>' +
                            '<div class="filter-loading" style="display: none;">' +
                                '<i class="fas fa-spinner fa-spin"></i> Applying filter...' +
                            '</div>' +
                            '</div>');
                        
                        // Add burger menu to header (next to existing content)
                        $header.append(burgerMenu);
                        $header.append(dropdown);
                        
                        // Toggle dropdown on burger menu click
                        burgerMenu.on('click', function(e) {
                            e.stopPropagation();
                            
                            // Close other dropdowns
                            $('.enhanced-filter-dropdown').removeClass('show');
                            $('.column-burger-menu').removeClass('active');
                            
                            // Toggle current dropdown
                            dropdown.toggleClass('show');
                            burgerMenu.toggleClass('active');
                        });
                        
                        // Apply filter with debouncing for search input
                        const applyFilter = function() {
                            var operator = dropdown.find('.filter-operator-select').val();
                            var value = dropdown.find('.filter-search-input').val();
                            
                            if (value || operator === 'empty' || operator === 'not_empty') {
                                if (isServerSide) {
                                    // Show loading indicator
                                    dropdown.find('.filter-loading').show();
                                    dropdown.find('.filter-actions').hide();
                                    
                                    // Store filter in columnFilters
                                    if (operator === 'empty' || operator === 'not_empty') {
                                        self.columnFilters[tableId][columnField] = {
                                            operator: operator === 'empty' ? 'equals' : 'ne',
                                            value: ''
                                        };
                                    } else if (operator === 'not_contains') {
                                        // Backend doesn't support not_contains, we'll need to handle this client-side
                                        console.warn('not_contains operator not supported server-side, using contains for now');
                                        self.columnFilters[tableId][columnField] = {
                                            operator: 'contains',
                                            value: value
                                        };
                                    } else {
                                        self.columnFilters[tableId][columnField] = {
                                            operator: operator,
                                            value: value
                                        };
                                    }
                                    
                                    // Trigger table redraw which will include filters in request
                                    api.ajax.reload(function() {
                                        // Hide loading indicator
                                        dropdown.find('.filter-loading').hide();
                                        dropdown.find('.filter-actions').show();
                                    });
                                } else {
                                    // Client-side filtering with regex
                                    var searchRegex = self.buildFilterRegex(operator, value);
                                    column.search(searchRegex, true, false).draw();
                                }
                                
                                // Visual feedback - highlight burger menu when filter is active
                                burgerMenu.addClass('filtered');
                            }
                            
                            dropdown.removeClass('show');
                            burgerMenu.removeClass('active');
                        };
                        
                        // Apply filter button
                        dropdown.find('.apply-filter').on('click', applyFilter);
                        
                        // Debounced search input
                        dropdown.find('.filter-search-input').on('keyup', function(e) {
                            // Apply immediately on Enter
                            if (e.keyCode === 13) {
                                applyFilter();
                                return;
                            }
                            
                            // Otherwise debounce
                            clearTimeout(self.filterDebounceTimer);
                            self.filterDebounceTimer = setTimeout(function() {
                                if (isServerSide && dropdown.find('.filter-search-input').val()) {
                                    applyFilter();
                                }
                            }, 500); // 500ms debounce
                        });
                        
                        // Clear filter
                        dropdown.find('.clear-filter').on('click', function() {
                            if (isServerSide) {
                                // Remove filter from columnFilters
                                delete self.columnFilters[tableId][columnField];
                                
                                // Show loading
                                dropdown.find('.filter-loading').show();
                                dropdown.find('.filter-actions').hide();
                                
                                // Trigger table redraw
                                api.ajax.reload(function() {
                                    dropdown.find('.filter-loading').hide();
                                    dropdown.find('.filter-actions').show();
                                });
                            } else {
                                column.search('').draw();
                            }
                            dropdown.find('.filter-search-input').val('');
                            dropdown.find('.filter-operator-select').val('contains');
                            burgerMenu.removeClass('filtered');
                            dropdown.removeClass('show');
                            burgerMenu.removeClass('active');
                        });
                        
                        // Sort buttons
                        dropdown.find('.filter-sort-btn').on('click', function() {
                            var sortType = $(this).data('sort');
                            
                            dropdown.find('.filter-sort-btn').removeClass('active');
                            $(this).addClass('active');
                            
                            if (sortType === 'clear') {
                                api.order.neutral().draw();
                            } else {
                                column.order(sortType).draw();
                            }
                            
                            dropdown.removeClass('show');
                            burgerMenu.removeClass('active');
                        });
                        
                        // Prevent dropdown close when clicking inside
                        dropdown.on('click', function(e) {
                            e.stopPropagation();
                        });
                    });
                    
                    // Close dropdowns when clicking outside
                    $(document).on('click', function() {
                        $('.enhanced-filter-dropdown').removeClass('show');
                        $('.column-burger-menu').removeClass('active');
                    });
                }
            }
        }
    </script>
</body>
</html>